{
  "id": "aliyun",
  "name": "阿里云 RAM SSO",
  "description": "阿里云 RAM 用户 SSO 登录",
  
  "triggers": ["aliyun", "阿里云", "ram", "alibaba", "阿里巴巴"],
  
  "selectors": {
    "username": {
      "selector": "input[name='username']",
      "fallback": [
        "input[type='email']",
        "input[id*='email']",
        "input[id*='phone']",
        "input[id*='user']",
        "input[placeholder*='账号']",
        "input[placeholder*='邮箱']",
        "input[placeholder*='手机']"
      ]
    },
    "password": {
      "selector": "input[type='password']",
      "fallback": [
        "input[name='password']",
        "input[id='loginPassword']",
        "input[placeholder*='密码']"
      ]
    },
    "nextButton": {
      "selector": "button:has-text('Next')",
      "fallback": [
        "button[type='submit']",
        "button:has-text('下一步')",
        "button:has-text('继续')"
      ]
    },
    "loginButton": {
      "selector": "button:has-text('Log On')",
      "fallback": [
        "button:has-text('登录')",
        "button:has-text('Sign in')",
        "button[type='submit']"
      ]
    },
    "mfaTab": {
      "sms": "tab:has-text('Phone Number'), [role='tab']:has-text('Phone')",
      "totp": "tab:has-text('Virtual MFA'), [role='tab']:has-text('MFA')",
      "email": "tab:has-text('Email')"
    },
    "mfaInput": {
      "sms": "input[placeholder*='verification code'], input[placeholder*='验证码'], input[name='code']",
      "totp": "input[placeholder*='security code'], input[name='code']",
      "fallback": "input[type='text'][maxlength='6'], input[type='tel']"
    },
    "getCodeButton": {
      "selector": "button:has-text('Obtain'), button:has-text('Get'), button:has-text('获取'), button:has-text('Send')",
      "fallback": [
        "button[class*='send-code']",
        "button[class*='get-code']"
      ]
    },
    "submitButton": {
      "selector": "button:has-text('Submit'), button:has-text('Confirm'), button:has-text('提交'), button:has-text('确定')",
      "fallback": [
        "button[type='submit']",
        "button:has-text('Verify')"
      ]
    },
    "authorizeButton": {
      "selector": "button:has-text('Authorize'), button:has-text('授权')",
      "fallback": [
        "button[type='submit']:has-text('Allow')",
        "button:has-text('同意')"
      ]
    }
  },
  
  "mfa": {
    "defaultType": "sms",
    "types": ["sms", "totp"],
    "sms": {
      "needPhoneInput": false,
      "promptTemplate": "验证码已发送到 {phone}，请输入 6 位验证码：",
      "codeRegex": "\\d{6}",
      "maxWaitSeconds": 300,
      "resendTimeout": 60
    },
    "totp": {
      "promptTemplate": "请查看您的 TOTP 验证器应用，输入 6 位验证码：",
      "codeRegex": "\\d{6}"
    }
  },
  
  "detection": {
    "loginPageText": "RAM User Logon",
    "mfaPageText": "An unusual logon is detected",
    "codeSentText": "verification code is sent",
    "successText": "Welcome to Elastic",
    "errorTexts": [
      "verification code is invalid",
      "password is incorrect",
      "username does not exist",
      "账号不存在",
      "密码错误",
      "验证码错误"
    ]
  },
  
  "flows": {
    "usernameFirst": true,
    "separatePasswordStep": true,
    "mfaRequired": true,
    "authorizationStep": true
  },
  
  "hooks": {
    "preFill": null,
    "postMFA": null,
    "preAuthorize": null,
    "automation": {
      "enabled": false,
      "smsProvider": null,
      "captchaSolver": null
    }
  },
  
  "notes": {
    "captcha": "阿里云可能显示滑块验证码，无法自动处理，需人工介入",
    "phoneMask": "手机号显示为 156****9136 格式，非完整号码",
    "sessionTimeout": "验证码 5 分钟有效，超时需重新获取"
  }
}
